<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Civic Rights Alert System - Track Legislation, Protect Your Rights</title>

  <!-- React 18 (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel (in-browser) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Work+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --liberty-blue: #1e3a8a;
      --liberty-blue-light: #3b82f6;
      --liberty-blue-dark: #0f172a;
      --freedom-red: #dc2626;
      --justice-gold: #fbbf24;

      --neutral-50: #f8fafc;
      --neutral-100: #f1f5f9;
      --neutral-200: #e2e8f0;
      --neutral-300: #cbd5e1;
      --neutral-700: #334155;
      --neutral-800: #1e293b;
      --neutral-900: #0f172a;
    }

    body {
      font-family: 'Work Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: var(--neutral-100);
      min-height: 100vh;
      color: var(--neutral-800);
      line-height: 1.6;
    }

    .heading-display {
      font-family: 'Crimson Pro', Georgia, serif;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .heading-primary {
      font-family: 'Work Sans', sans-serif;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }
    @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
    @keyframes pulse { 0%, 100% { opacity: 1;} 50% { opacity: 0.7;} }
    @keyframes slideFromRight { from { transform: translateX(100%);} to { transform: translateX(0);} }

    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Work Sans', sans-serif;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9375rem;
    }

    .btn:hover { transform: translateY(-1px); box-shadow: 0 6px 16px -4px rgba(0, 0, 0, 0.15); }
    .btn:active { transform: translateY(0); }

    .btn-primary {
      background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      color: white;
    }

    .btn-secondary {
      background: white;
      color: #1e3a8a;
      border: 2px solid #1e3a8a;
    }

    .card {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
      transition: all 0.2s ease;
    }
    .card:hover { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04); transform: translateY(-2px); }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1rem;
      animation: fadeIn 0.2s ease-out;
    }

    .modal-content {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 0.25s ease-out;
    }

    .spinner {
      border: 3px solid #e2e8f0;
      border-top: 3px solid #1e3a8a;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    .sidebar-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.5);
      z-index: 200;
      animation: fadeIn 0.2s ease-out;
    }

    .sidebar-drawer {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 320px;
      max-width: 85vw;
      background: white;
      z-index: 201;
      overflow-y: auto;
      box-shadow: -8px 0 30px rgba(0,0,0,0.15);
      animation: slideFromRight 0.25s ease-out;
      padding: 2rem 1.5rem;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }

    @media (max-width: 768px) { .desktop-only { display: none !important; } }
    @media (min-width: 769px) { .mobile-only { display: none !important; } }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // =========================================================
    // GLOBAL CONSTANTS
    // =========================================================
    const PAGE_SIZE = 50;

    // =========================================================
    // UTILITY FUNCTIONS
    // =========================================================
    const formatDate = (dateStr) => {
      if (!dateStr) return '';
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    };

    const stripHtml = (html) => {
      if (!html) return '';
      let text = html
        .replace(/<\/p>/gi, ' ')
        .replace(/<p>/gi, ' ')
        .replace(/<br\s*\/?>/gi, ' ')
        .replace(/<\/div>/gi, ' ')
        .replace(/<div>/gi, ' ');
      const tmp = document.createElement('div');
      tmp.innerHTML = text;
      return (tmp.textContent || tmp.innerText || '').replace(/\s+/g, ' ').trim();
    };

    const calculateDaysUntil = (dateStr) => {
      if (!dateStr) return null;
      const target = new Date(dateStr);
      const now = new Date();
      const diffTime = target - now;
      return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    };

    // =========================================================
    // AZ CITY PORTALS REGISTRY (Legistar + non-Legistar)
    // =========================================================
    // Convention:
    // - If system === 'legistar' => meeting calendar is `${base}/Calendar.aspx`
    // - Otherwise => open `base` as-is
    const AZ_CITY_PORTALS = {
      "Apache Junction, AZ": { system: "legistar", base: "https://apachejunction.legistar.com" },
      "Avondale, AZ": { system: "civicclerk", base: "https://avondaleaz.portal.civicclerk.com/" },
      "Benson, AZ": { system: "citysite", base: "https://www.bensonaz.gov/government/city_council/agendas_minutes___public_notices.php" },
      "Bisbee, AZ": { system: "citysite", base: "https://www.bisbeeaz.gov/66/Agendas-Minutes" },
      "Camp Verde, AZ": { system: "citysite", base: "https://www.campverde.az.gov/government/town_council/agendas_minutes.php" },
      "Coolidge, AZ": { system: "citysite", base: "https://www.coolidgeaz.com/index.asp?SEC=D192363A-7D8F-4DB2-ABE7-68D2F6DE3894" },
      "Cottonwood, AZ": { system: "citysite", base: "https://cottonwoodaz.gov/129/Agendas-Minutes" },
      "Douglas, AZ": { system: "citysite", base: "https://www.douglasaz.gov/AgendaCenter" },
      "Eloy, AZ": { system: "granicus", base: "https://eloyaz.gov/574/Agendas-Minutes-Public-Notices" },
      "Flagstaff, AZ": { system: "destinyhosted", base: "https://www.flagstaff.az.gov/991/Agendas-Minutes" },
      "Glendale, AZ": { system: "legistar", base: "https://glendale-az.legistar.com" },
      "Goodyear, AZ": { system: "legistar", base: "https://goodyear.legistar.com" },
      "Kingman, AZ": { system: "citysite", base: "https://www.cityofkingman.gov/government/agendas-minutes" },
      "Lake Havasu City, AZ": { system: "legistar", base: "https://lakehavasucity.legistar.com" },
      "Maricopa, AZ": { system: "legistar", base: "https://maricopa.legistar.com" },
      "Mesa, AZ": { system: "legistar", base: "https://mesa.legistar.com" },
      "Peoria, AZ": { system: "citysite", base: "https://www.peoriaaz.gov/residents/public-meetings/city-council-meetings" },
      "Phoenix, AZ": { system: "legistar", base: "https://phoenix.legistar.com" },
      "Prescott, AZ": { system: "civicclerk", base: "https://prescottaz.portal.civicclerk.com/" },
      "Safford, AZ": { system: "citysite", base: "https://www.cityofsafford.us/AgendaCenter" },
      "San Luis, AZ": { system: "citysite", base: "https://www.sanluisaz.gov/AgendaCenter" },
      "Scottsdale, AZ": { system: "granicus", base: "https://ww2.scottsdaleaz.gov/council/meeting-information/agendas-minutes" },
      "Sedona, AZ": { system: "citysite", base: "https://www.sedonaaz.gov/your-government/meetings-documents" },
      "Show Low, AZ": { system: "citysite", base: "https://www.showlowaz.gov/o/cosl/page/open-meeting-law-information" },
      "Surprise, AZ": { system: "civicclerk", base: "https://surpriseaz.portal.civicclerk.com/" },
      "Tempe, AZ": { system: "onbase", base: "https://tempe.hylandcloud.com/AgendaOnline" },
      "Tolleson, AZ": { system: "civicclerk", base: "https://tollesonaz.portal.civicclerk.com/" },
      "Tombstone, AZ": { system: "citysite", base: "https://cityoftombstoneaz.gov/agendas-minutes/" },
      "Tucson, AZ": { system: "citysite", base: "https://www.tucsonaz.gov/Government/Mayor-Council-and-City-Manager/Meeting-Schedules-Agendas" },
      "Willcox, AZ": { system: "citysite", base: "https://willcox.az.gov/city-council-agendas-minutes-archive" },
      "Williams, AZ": { system: "citysite", base: "https://www.williamsaz.gov/government/meetings/city_council" },
      "Winslow, AZ": { system: "citysite", base: "https://www.winslowaz.gov/page/boards-agendas-minutes" },
      "Yuma, AZ": { system: "legistar", base: "https://yuma-az.legistar.com" }
    };

    const getCityPortalEntry = (cityLabel) => AZ_CITY_PORTALS[cityLabel] || null;

    const getCityPortalUrl = (cityLabel) => {
      const entry = getCityPortalEntry(cityLabel);
      return entry ? entry.base : '';
    };

    const getCityCalendarUrl = (cityLabel) => {
      const entry = getCityPortalEntry(cityLabel);
      if (!entry) return '';
      if (entry.system === 'legistar') return `${entry.base}/Calendar.aspx`;
      return entry.base;
    };

    // Back-compat name used elsewhere:
    const getPortalBaseForCity = (cityLabel) => getCityPortalUrl(cityLabel);

    // =========================================================
    // SMALL UI PIECES
    // =========================================================
    function StatusBadge({ statusPriority, statusDisplay }) {
      const styleFor = (p) => {
        if (p >= 10) return { bg: '#dcfce7', color: '#166534', border: '#86efac', icon: '‚úÖ' };
        if (p === 9) return { bg: '#fee2e2', color: '#991b1b', border: '#fca5a5', icon: 'üö®' };
        if (p === 8) return { bg: '#fed7aa', color: '#9a3412', border: '#fdba74', icon: 'üö®' };
        if (p === 7) return { bg: '#fef3c7', color: '#92400e', border: '#fde68a', icon: '‚ö†Ô∏è' };
        if (p >= 5) return { bg: '#dbeafe', color: '#1e3a8a', border: '#93c5fd', icon: 'üìã' };
        if (p >= 3) return { bg: '#e0e7ff', color: '#3730a3', border: '#c7d2fe', icon: 'üìÑ' };
        return { bg: '#f3f4f6', color: '#374151', border: '#d1d5db', icon: 'üìÑ' };
      };
      const s = styleFor(statusPriority || 0);
      return (
        <div style={{
          display: 'inline-flex', alignItems: 'center', gap: '0.5rem',
          padding: '0.375rem 0.75rem',
          backgroundColor: s.bg, color: s.color,
          borderRadius: '0.5rem',
          border: `2px solid ${s.border}`,
          fontWeight: 600, fontSize: '0.8125rem'
        }}>
          <span>{s.icon}</span><span>{statusDisplay || 'Status'}</span>
        </div>
      );
    }

    function CountdownTimer({ voteDate }) {
      const [timeLeft, setTimeLeft] = useState('');
      useEffect(() => {
        if (!voteDate) return;
        const update = () => {
          const daysLeft = calculateDaysUntil(voteDate);
          if (daysLeft < 0) setTimeLeft('Vote completed');
          else if (daysLeft === 0) setTimeLeft('VOTE TODAY!');
          else if (daysLeft === 1) setTimeLeft('VOTE TOMORROW!');
          else if (daysLeft <= 7) setTimeLeft(`VOTE IN ${daysLeft} DAYS`);
          else setTimeLeft(`Vote in ${daysLeft} days`);
        };
        update();
        const t = setInterval(update, 60000);
        return () => clearInterval(t);
      }, [voteDate]);

      if (!voteDate) return null;
      const daysLeft = calculateDaysUntil(voteDate);
      if (daysLeft > 14) return null;
      const isUrgent = daysLeft <= 3 && daysLeft >= 0;

      return (
        <div style={{
          backgroundColor: isUrgent ? '#fee2e2' : '#fef3c7',
          border: `2px solid ${isUrgent ? '#fca5a5' : '#fde68a'}`,
          borderRadius: '0.75rem',
          padding: '0.75rem 1rem',
          marginTop: '0.75rem',
          display: 'flex', alignItems: 'center', gap: '0.75rem',
          animation: isUrgent ? 'pulse 2s ease-in-out infinite' : 'none'
        }}>
          <div style={{ fontSize: '1.5rem' }}>‚è∞</div>
          <div style={{ flex: 1 }}>
            <div style={{ fontWeight: 700, color: isUrgent ? '#991b1b' : '#92400e', fontSize: '1rem' }}>
              {timeLeft}
            </div>
            <div style={{ fontSize: '0.8125rem', color: '#334155' }}>
              Expected vote: {formatDate(voteDate)}
            </div>
          </div>
        </div>
      );
    }

    function BillTitle({ bill }) {
      const title = bill?.title || '';
      const number = bill?.number || '';
      const url = bill?.public_url || bill?.congress_url || bill?.legiscan_url || bill?.url || '#';
      return (
        <h3 style={{ fontWeight: 700, fontSize: '1.15rem', marginBottom: '0.5rem', color: '#0f172a' }}>
          <a
            href={url}
            target="_blank"
            rel="noopener noreferrer"
            style={{ color: '#1e3a8a', textDecoration: 'underline', cursor: 'pointer' }}
            onClick={(e) => e.stopPropagation()}
          >
            {number}
          </a>
          {title ? ` ‚Äî ${title}` : ''}
        </h3>
      );
    }

    function BillCard({ bill, onViewDetails, watchlist, toggleWatchlist }) {
      return (
        <div className="card" style={{ marginBottom: '1rem', borderLeft: '4px solid #3b82f6' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.5rem' }}>
            <div style={{ flex: 1 }}>
              <BillTitle bill={bill} />
              <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.5rem' }}>
                <StatusBadge statusPriority={bill.statusPriority} statusDisplay={bill.statusDisplay || bill.status} />
                {bill.date && <span style={{ fontSize: '0.75rem', color: '#64748b' }}>Last action: {formatDate(bill.date)}</span>}
              </div>
            </div>

            <button
              onClick={(e) => { e.stopPropagation(); toggleWatchlist(bill.id); }}
              style={{
                background: 'none', border: 'none', fontSize: '1.75rem',
                cursor: 'pointer', padding: '0.25rem',
                filter: watchlist.includes(bill.id) ? 'none' : 'grayscale(100%)',
                opacity: watchlist.includes(bill.id) ? 1 : 0.4
              }}
              title={watchlist.includes(bill.id) ? 'Remove from watchlist' : 'Add to watchlist'}
            >
              ‚≠ê
            </button>
          </div>

          <p style={{ color: '#334155', marginBottom: '0.75rem', lineHeight: '1.6', fontSize: '0.9375rem' }}>
            {stripHtml(bill.howItAffectsYou || bill.title || '')}
          </p>

          {bill.voteDate && <CountdownTimer voteDate={bill.voteDate} />}

          <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.75rem' }}>
            <button onClick={() => onViewDetails(bill)} className="btn btn-primary" style={{ flex: 1 }}>
              üìã View Details
            </button>
            <button onClick={() => window.open(bill.public_url || bill.congress_url || bill.legiscan_url || bill.url, '_blank', 'noopener,noreferrer')} className="btn btn-secondary" style={{ flex: '0 0 auto' }}>
              üìÑ Read
            </button>
          </div>
        </div>
      );
    }

    // =========================================================
    // CITY COUNCIL VIEW (Legistar-only deep data; portal works for all)
    // =========================================================
    function CityCouncilView({ city, onBack }) {
      const [members, setMembers] = useState([]);
      const [legislation, setLegislation] = useState([]);
      const [meetings, setMeetings] = useState([]);
      const [loading, setLoading] = useState(true);
      const [activeSection, setActiveSection] = useState('members');

      const portalUrl = getCityPortalUrl(city);
      const calendarUrl = getCityCalendarUrl(city);

      useEffect(() => {
        if (!city) return;

        // For non-Legistar cities, we still show portal/calendar link, but deep data may be empty.
        const fetchData = async () => {
          setLoading(true);
          try {
            const [membersRes, legRes, meetRes] = await Promise.all([
              fetch(`/.netlify/functions/city-council?city=${encodeURIComponent(city)}&type=members`).then(r => r.json()).catch(() => ({ members: [] })),
              fetch(`/.netlify/functions/city-council?city=${encodeURIComponent(city)}&type=legislation`).then(r => r.json()).catch(() => ({ legislation: [] })),
              fetch(`/.netlify/functions/city-council?city=${encodeURIComponent(city)}&type=meetings`).then(r => r.json()).catch(() => ({ meetings: [] })),
            ]);
            setMembers(membersRes.members || []);
            setLegislation(legRes.legislation || []);
            setMeetings(meetRes.meetings || []);
          } catch (e) {
            console.error(e);
          } finally {
            setLoading(false);
          }
        };

        fetchData();
      }, [city]);

      if (loading) {
        return (
          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', padding: '4rem', gap: '1rem' }}>
            <div className="spinner"></div>
            <p style={{ color: '#64748b' }}>Loading {city} council data...</p>
          </div>
        );
      }

      return (
        <div>
          <div style={{ background: 'linear-gradient(135deg, #0f172a, #1e3a8a)', borderRadius: '1rem', padding: '1.5rem', marginBottom: '1.5rem', color: 'white' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
              <h2 style={{ fontSize: '1.5rem', fontWeight: 700 }}>üèõÔ∏è {city} Council</h2>
              <button onClick={onBack} style={{ background: 'rgba(255,255,255,0.15)', border: 'none', color: 'white', padding: '0.5rem 1rem', borderRadius: '0.5rem', cursor: 'pointer', fontWeight: 600, fontSize: '0.8125rem' }}>
                ‚Üê Back
              </button>
            </div>

            <div style={{ display: 'flex', gap: '1.5rem', fontSize: '0.9375rem', opacity: 0.9, flexWrap: 'wrap' }}>
              <span>üë• {members.length} Members</span>
              <span>üìã {legislation.length} Items</span>
              <span>üìÖ {meetings.length} Meetings</span>
            </div>

            <div style={{ display: 'flex', gap: '0.75rem', marginTop: '1rem', flexWrap: 'wrap' }}>
              <button
                className="btn btn-secondary"
                onClick={() => { if (calendarUrl) window.open(calendarUrl, '_blank'); }}
                style={{ justifyContent: 'center' }}
                disabled={!calendarUrl}
                title={!calendarUrl ? 'No portal mapped yet' : 'Open meeting portal'}
              >
                üóìÔ∏è Open Meeting Portal
              </button>

              <button
                className="btn btn-secondary"
                onClick={() => { if (portalUrl) window.open(portalUrl, '_blank'); }}
                style={{ justifyContent: 'center' }}
                disabled={!portalUrl}
                title={!portalUrl ? 'No portal mapped yet' : 'Open portal home'}
              >
                üåê Portal Home
              </button>
            </div>
          </div>

          <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.5rem' }}>
            {[
              { key: 'members', label: 'üë• Council Members', count: members.length },
              { key: 'legislation', label: 'üìã Legislation', count: legislation.length },
              { key: 'meetings', label: 'üìÖ Meetings', count: meetings.length }
            ].map(tab => (
              <button
                key={tab.key}
                onClick={() => setActiveSection(tab.key)}
                style={{
                  flex: 1,
                  padding: '0.75rem',
                  border: 'none',
                  background: activeSection === tab.key ? '#1e3a8a' : 'white',
                  color: activeSection === tab.key ? 'white' : '#334155',
                  fontWeight: 700,
                  cursor: 'pointer',
                  borderRadius: '0.5rem',
                  fontSize: '0.875rem'
                }}
              >
                {tab.label} ({tab.count})
              </button>
            ))}
          </div>

          {activeSection === 'members' && (
            <div>
              {members.length === 0 ? (
                <div style={{ textAlign: 'center', padding: '3rem', background: 'white', borderRadius: '1rem' }}>
                  <p style={{ color: '#64748b' }}>
                    No member data available from the API for this city yet. Use the portal links above.
                  </p>
                </div>
              ) : (
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))', gap: '1rem' }}>
                  {members.map(m => (
                    <div key={m.id || m.fullName} className="card" style={{ padding: '1.25rem' }}>
                      <h3 style={{ fontWeight: 700, color: '#1e3a8a', fontSize: '1.1rem', marginBottom: '0.25rem' }}>{m.fullName || 'Member'}</h3>
                      {m.title && <div style={{ fontSize: '0.8125rem', color: '#64748b' }}>{m.title}</div>}
                      {m.email && <div style={{ marginTop: '0.5rem', fontSize: '0.8125rem' }}>üìß <a href={`mailto:${m.email}`} style={{ color: '#1e3a8a' }}>{m.email}</a></div>}
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {activeSection === 'legislation' && (
            <div>
              {legislation.length === 0 ? (
                <div style={{ textAlign: 'center', padding: '3rem', background: 'white', borderRadius: '1rem' }}>
                  <p style={{ color: '#64748b' }}>No recent legislation found via API. Use the portal links above.</p>
                </div>
              ) : (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                  {legislation.map(item => (
                    <div key={item.id || item.file || item.name} className="card" style={{ padding: '1.25rem', borderLeft: '4px solid #3b82f6' }}>
                      <div style={{ fontWeight: 700, color: '#1e3a8a', fontSize: '0.9375rem' }}>{item.file || item.type || 'Item'}</div>
                      <div style={{ fontWeight: 700, fontSize: '1rem', color: '#0f172a', marginTop: '0.25rem' }}>
                        {item.title || item.name || 'Untitled'}
                      </div>
                      {item.introduced && <div style={{ fontSize: '0.75rem', color: '#94a3b8' }}>Introduced: {formatDate(item.introduced)}</div>}
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {activeSection === 'meetings' && (
            <div>
              {meetings.length === 0 ? (
                <div style={{ textAlign: 'center', padding: '3rem', background: 'white', borderRadius: '1rem' }}>
                  <p style={{ color: '#64748b' }}>No upcoming meetings found via API. Use the portal links above.</p>
                </div>
              ) : (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                  {meetings.map(meeting => (
                    <div key={meeting.id || meeting.date} className="card" style={{ padding: '1.25rem', borderLeft: '4px solid #3b82f6' }}>
                      <h3 style={{ fontWeight: 700, fontSize: '1.1rem', color: '#1e3a8a', marginBottom: '0.25rem' }}>
                        {meeting.bodyName || 'Meeting'}
                      </h3>
                      <div style={{ fontSize: '0.9375rem', color: '#334155', fontWeight: 600 }}>
                        üìÖ {formatDate(meeting.date)} {meeting.time ? `at ${meeting.time}` : ''}
                      </div>
                      {meeting.location && <div style={{ fontSize: '0.8125rem', color: '#64748b', marginTop: '0.25rem' }}>üìç {meeting.location}</div>}
                      {(meeting.agendaURL || meeting.inSiteURL) && (
                        <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.75rem', flexWrap: 'wrap' }}>
                          {meeting.agendaURL && <button onClick={() => window.open(meeting.agendaURL, '_blank')} className="btn btn-primary" style={{ fontSize: '0.8125rem', padding: '0.5rem 1rem' }}>üìã View Agenda</button>}
                          {meeting.inSiteURL && <button onClick={() => window.open(meeting.inSiteURL, '_blank')} className="btn btn-secondary" style={{ fontSize: '0.8125rem', padding: '0.5rem 1rem' }}>üåê Meeting Page</button>}
                          {meeting.videoURL && <button onClick={() => window.open(meeting.videoURL, '_blank')} className="btn btn-secondary" style={{ fontSize: '0.8125rem', padding: '0.5rem 1rem' }}>üìπ Watch</button>}
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          <div style={{ marginTop: '1.5rem', textAlign: 'center', fontSize: '0.75rem', color: '#94a3b8' }}>
            Portal:{" "}
            {portalUrl ? (
              <a href={portalUrl} target="_blank" rel="noopener noreferrer" style={{ color: '#64748b' }}>
                {portalUrl}
              </a>
            ) : (
              <span>(not mapped yet)</span>
            )}
          </div>
        </div>
      );
    }

    // =========================================================
    // BILL DETAILS MODAL (minimal)
    // =========================================================
    function BillDetailsModal({ bill, onClose }) {
      if (!bill) return null;
      return (
        <div className="modal-overlay" onClick={onClose}>
          <div className="modal-content" onClick={(e) => e.stopPropagation()}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
              <h2 className="heading-primary" style={{ fontSize: '1.25rem', color: '#1e3a8a' }}>
                {bill.number} ‚Äî {bill.title}
              </h2>
              <button onClick={onClose} style={{ background: 'none', border: 'none', fontSize: '1.5rem', cursor: 'pointer' }}>‚úï</button>
            </div>

            <div style={{ marginBottom: '1rem' }}>
              <StatusBadge statusPriority={bill.statusPriority} statusDisplay={bill.statusDisplay || bill.status} />
              {bill.date && <div style={{ marginTop: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>Last action: {formatDate(bill.date)}</div>}
            </div>

            <div className="card" style={{ background: '#f8fafc', border: '2px solid #e2e8f0' }}>
              <div style={{ fontWeight: 700, marginBottom: '0.5rem', color: '#1e293b' }}>How this affects you</div>
              <div style={{ color: '#334155' }}>{stripHtml(bill.howItAffectsYou || bill.title || '')}</div>
            </div>

            <div style={{ marginTop: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
              <button className="btn btn-primary" onClick={() => window.open(bill.public_url || bill.congress_url || bill.legiscan_url || bill.url, '_blank', 'noopener,noreferrer')}>
                üìÑ Open Source
              </button>
              <button className="btn btn-secondary" onClick={onClose}>
                Close
              </button>
            </div>
          </div>
        </div>
      );
    }

    // =========================================================
    // MAIN APP
    // =========================================================
    function CivicAlertApp() {
      const [bills, setBills] = useState([]);
      const [billsOffset, setBillsOffset] = useState(0);
      const [hasMoreBills, setHasMoreBills] = useState(true);

      const [loading, setLoading] = useState(true);
      const [filterTopic, setFilterTopic] = useState('all');
      const [searchQuery, setSearchQuery] = useState('');
      const [sortBy, setSortBy] = useState('urgent');

      const [activeTab, setActiveTab] = useState('all');
      const [level, setLevel] = useState('federal');

      const [selectedState, setSelectedState] = useState('');
      const [selectedCity, setSelectedCity] = useState('');

      const [watchlist, setWatchlist] = useState(() => {
        const s = localStorage.getItem('billWatchlist');
        return s ? JSON.parse(s) : [];
      });

      const [selectedBill, setSelectedBill] = useState(null);
      const [showDrawer, setShowDrawer] = useState(false);
      const [showFilters, setShowFilters] = useState(false);

      useEffect(() => {
        localStorage.setItem('billWatchlist', JSON.stringify(watchlist));
      }, [watchlist]);

      const toggleWatchlist = (billId) => {
        setWatchlist(prev => prev.includes(billId) ? prev.filter(id => id !== billId) : [...prev, billId]);
      };

      const getBillTopic = (bill) => {
        const combined = (String(bill.title || '') + ' ' + String(bill.howItAffectsYou || '')).toLowerCase();
        const topics = {
          privacy: ['privacy','surveillance','data collection','facial recognition','biometric','tracking','encryption','warrant','fourth amendment','cybersecurity','backdoor','fisa','patriot act'],
          healthcare: ['health','medical','hospital','medicare','medicaid','insurance','prescription','drug','pharmacy','vaccine','mental health','opioid','abortion','reproductive','affordable care act'],
          taxes: ['tax','irs','deduction','credit','income tax','property tax','estate tax','capital gains','revenue','tariff','taxpayer','refund'],
          guns: ['gun','firearm','weapon','ammunition','second amendment','background check','concealed carry','assault weapon','atf'],
          voting: ['voting','voter','election','ballot','registration','voter id','redistricting','campaign finance','absentee','early voting'],
          education: ['education','school','student','teacher','university','college','tuition','student loan','scholarship','title ix','pell grant'],
          climate: ['climate','environment','pollution','emission','carbon','renewable','solar','wind','fossil fuel','epa','clean air','clean water'],
          immigration: ['immigration','immigrant','border','visa','refugee','asylum','deportation','citizenship','naturalization','green card','daca','dreamers'],
          justice: ['justice','criminal','prison','jail','sentencing','police','law enforcement','civil rights','discrimination','due process','bail','death penalty'],
          labor: ['labor','worker','employment','wage','minimum wage','overtime','union','collective bargaining','osha','unemployment','paid leave','sick leave']
        };

        for (const [topic, keywords] of Object.entries(topics)) {
          if (keywords.some(kw => combined.includes(kw))) return topic;
        }
        return 'other';
      };

      // Reset pagination when scope changes
      useEffect(() => {
        setBillsOffset(0);
        setHasMoreBills(true);
      }, [level, selectedState]);

      // Fetch bills with pagination
      useEffect(() => {
        const fetchBills = async () => {
          try {
            setLoading(true);

            let url = '';
            if (level === 'federal') {
              url = `/.netlify/functions/get-bills?limit=${PAGE_SIZE}&offset=${billsOffset}`;
            } else if (level === 'state' && selectedState) {
              url = `/.netlify/functions/state-bills?state=${selectedState}&limit=${PAGE_SIZE}&offset=${billsOffset}`;
            } else {
              setBills([]);
              setHasMoreBills(false);
              setLoading(false);
              return;
            }

            const response = await fetch(url);
            if (!response.ok) throw new Error(`API error: ${response.status}`);

            const data = await response.json();
            const incoming = Array.isArray(data?.bills) ? data.bills : [];
            const newBills = incoming.map(bill => ({ ...bill, topic: getBillTopic(bill) }));

            setBills(prev => (billsOffset === 0 ? newBills : [...prev, ...newBills]));
            setHasMoreBills(newBills.length === PAGE_SIZE);
          } catch (error) {
            console.error('Error fetching bills:', error);
            setBills([]);
            setHasMoreBills(false);
          } finally {
            setLoading(false);
          }
        };

        fetchBills();
      }, [level, selectedState, billsOffset]);

      const filteredBills = (() => {
        let result = bills;

        if (activeTab === 'watchlist') {
          result = result.filter(b => watchlist.includes(b.id));
        }

        if (filterTopic !== 'all') {
          result = result.filter(b => b.topic === filterTopic);
        }

        if (searchQuery.trim()) {
          const q = searchQuery.toLowerCase();
          result = result.filter(b =>
            String(b.number || '').toLowerCase().includes(q) ||
            String(b.title || '').toLowerCase().includes(q) ||
            String(b.howItAffectsYou || '').toLowerCase().includes(q)
          );
        }

        return [...result].sort((a, b) => {
          if (sortBy === 'recent') return new Date(b.date || 0) - new Date(a.date || 0);
          if (sortBy === 'oldest') return new Date(a.date || 0) - new Date(b.date || 0);
          return ((b.statusPriority || 0) - (a.statusPriority || 0)) || (new Date(b.date || 0) - new Date(a.date || 0));
        });
      })();

      const states = [
        'Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','Florida','Georgia',
        'Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland',
        'Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey',
        'New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina',
        'South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','West Virginia','Wisconsin','Wyoming'
      ];

      // AZ cities: show in dropdown only after selecting Arizona.
      const availableCities = Object.keys(AZ_CITY_PORTALS).slice().sort((a,b)=>a.localeCompare(b));

      const topicIcons = {
        all: 'üìã', privacy: 'üîí', healthcare: 'üè•', taxes: 'üí∞', guns: 'üî´', voting: 'üó≥Ô∏è', education: 'üìö',
        climate: 'üåç', immigration: 'üõÇ', justice: '‚öñÔ∏è', labor: 'üë∑', other: 'üìå'
      };

      return (
        <div style={{ minHeight: '100vh' }}>
          {/* Header */}
          <header style={{ background: 'linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%)', color: 'white', padding: '1.25rem 1rem', position: 'sticky', top: 0, zIndex: 100 }}>
            <div style={{ maxWidth: '960px', margin: '0 auto', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                <span style={{ fontSize: '1.5rem' }}>üá∫üá∏</span>
                <div>
                  <h1 className="heading-display" style={{ fontSize: '1.5rem', lineHeight: 1.2 }}>Civic Rights Alert System</h1>
                  <p style={{ margin: 0, fontSize: '0.75rem', opacity: 0.8 }}>Track legislation that affects your life</p>
                </div>
              </div>
              <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                <button onClick={() => setShowDrawer(true)} className="btn" style={{ backgroundColor: 'rgba(255,255,255,0.15)', color: 'white', padding: '0.5rem 0.75rem', fontSize: '1.25rem', lineHeight: 1 }}>‚ò∞</button>
              </div>
            </div>
          </header>

          {/* Main */}
          <main style={{ maxWidth: '960px', margin: '0 auto', padding: '1.5rem 1rem' }}>
            {/* Level selectors */}
            <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem', flexWrap: 'wrap', alignItems: 'center' }}>
              <button
                onClick={() => { setLevel('federal'); setSelectedState(''); setSelectedCity(''); setActiveTab('all'); }}
                style={{
                  padding: '0.625rem 1rem', borderRadius: '0.5rem',
                  border: level === 'federal' ? '2px solid #1e3a8a' : '2px solid #cbd5e1',
                  background: level === 'federal' ? '#1e3a8a' : 'white',
                  color: level === 'federal' ? 'white' : '#334155',
                  cursor: 'pointer', fontWeight: 600, fontSize: '0.9375rem'
                }}
              >
                üèõÔ∏è Federal
              </button>

              <div style={{ position: 'relative' }}>
                <select
                  value={selectedState}
                  onChange={(e) => {
                    const s = e.target.value;
                    setSelectedState(s);
                    setActiveTab('all');
                    setSelectedCity('');
                    if (s) setLevel('state');
                    else setLevel('federal');
                    // pagination reset handled by effect
                  }}
                  style={{
                    padding: '0.625rem 2rem 0.625rem 1rem',
                    borderRadius: '0.5rem',
                    border: level === 'state' ? '2px solid #1e3a8a' : '2px solid #cbd5e1',
                    background: level === 'state' ? '#1e3a8a' : 'white',
                    color: level === 'state' ? 'white' : '#334155',
                    cursor: 'pointer',
                    fontWeight: 600,
                    fontSize: '0.9375rem',
                    appearance: 'none',
                    WebkitAppearance: 'none'
                  }}
                >
                  <option value="">üèôÔ∏è Select State...</option>
                  {states.map(st => <option key={st} value={st}>{st}</option>)}
                </select>
                <span style={{
                  position: 'absolute', right: '0.75rem', top: '50%',
                  transform: 'translateY(-50%)',
                  pointerEvents: 'none', fontSize: '0.75rem',
                  color: level === 'state' ? 'white' : '#64748b'
                }}>‚ñº</span>
              </div>

              {/* AZ cities only show if Arizona selected */}
              {selectedState === 'Arizona' && (
                <div style={{ position: 'relative' }}>
                  <select
                    value={selectedCity}
                    onChange={(e) => {
                      const nextCity = e.target.value;
                      setSelectedCity(nextCity);
                      setActiveTab('all');
                      if (nextCity) setLevel('local');
                      else setLevel('state');
                    }}
                    style={{
                      padding: '0.625rem 2rem 0.625rem 1rem',
                      borderRadius: '0.5rem',
                      border: level === 'local' ? '2px solid #1e3a8a' : '2px solid #cbd5e1',
                      background: level === 'local' ? '#1e3a8a' : 'white',
                      color: level === 'local' ? 'white' : '#334155',
                      cursor: 'pointer',
                      fontWeight: 600,
                      fontSize: '0.9375rem',
                      appearance: 'none',
                      WebkitAppearance: 'none'
                    }}
                  >
                    <option value="">üåµ Select AZ City...</option>
                    {availableCities.map(c => <option key={c} value={c}>{c}</option>)}
                  </select>
                  <span style={{
                    position: 'absolute', right: '0.75rem', top: '50%',
                    transform: 'translateY(-50%)',
                    pointerEvents: 'none', fontSize: '0.75rem',
                    color: level === 'local' ? 'white' : '#64748b'
                  }}>‚ñº</span>
                </div>
              )}
            </div>

            {/* Local */}
            {level === 'local' && selectedCity ? (
              <CityCouncilView
                city={selectedCity}
                onBack={() => { setLevel('state'); setSelectedCity(''); }}
              />
            ) : (
              <>
                {/* Tabs */}
                <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
                  <button
                    onClick={() => setActiveTab('all')}
                    style={{
                      flex: 1, padding: '0.75rem', border: 'none',
                      background: activeTab === 'all' ? '#1e3a8a' : 'white',
                      color: activeTab === 'all' ? 'white' : '#334155',
                      fontWeight: 700, cursor: 'pointer', borderRadius: '0.5rem', fontSize: '0.9375rem'
                    }}
                  >
                    üìã All Bills
                  </button>
                  <button
                    onClick={() => setActiveTab('watchlist')}
                    style={{
                      flex: 1, padding: '0.75rem', border: 'none',
                      background: activeTab === 'watchlist' ? '#1e3a8a' : 'white',
                      color: activeTab === 'watchlist' ? 'white' : '#334155',
                      fontWeight: 700, cursor: 'pointer', borderRadius: '0.5rem', fontSize: '0.9375rem',
                      display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem'
                    }}
                  >
                    ‚≠ê Watchlist
                    {watchlist.length > 0 && (
                      <span style={{
                        backgroundColor: activeTab === 'watchlist' ? '#fbbf24' : '#1e3a8a',
                        color: activeTab === 'watchlist' ? '#0f172a' : 'white',
                        borderRadius: '9999px', padding: '0.125rem 0.5rem',
                        fontSize: '0.75rem', fontWeight: 700
                      }}>
                        {watchlist.length}
                      </span>
                    )}
                  </button>
                </div>

                {/* Search */}
                <div style={{ marginBottom: '1rem' }}>
                  <input
                    type="text"
                    value={searchQuery}
                    onChange={e => setSearchQuery(e.target.value)}
                    placeholder="Search by bill number or keyword..."
                    style={{
                      width: '100%', padding: '0.75rem 1rem', borderRadius: '0.5rem',
                      border: '2px solid #e2e8f0', fontSize: '1rem', background: 'white'
                    }}
                  />
                </div>

                {/* Topic pills */}
                <div style={{ display: 'flex', gap: '0.375rem', marginBottom: '0.75rem', overflowX: 'auto', paddingBottom: '0.5rem' }}>
                  {Object.entries(topicIcons).map(([value, icon]) => (
                    <button
                      key={value}
                      onClick={() => setFilterTopic(value)}
                      style={{
                        padding: '0.375rem 0.75rem',
                        borderRadius: '9999px',
                        border: filterTopic === value ? '2px solid #1e3a8a' : '2px solid #e2e8f0',
                        background: filterTopic === value ? '#1e3a8a' : 'white',
                        color: filterTopic === value ? 'white' : '#334155',
                        cursor: 'pointer',
                        fontWeight: 600,
                        fontSize: '0.8125rem',
                        whiteSpace: 'nowrap',
                        flexShrink: 0
                      }}
                    >
                      {icon} {value === 'all' ? 'All' : value.charAt(0).toUpperCase() + value.slice(1)}
                    </button>
                  ))}
                </div>

                {/* Filters */}
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
                  <button
                    onClick={() => setShowFilters(!showFilters)}
                    style={{ background: 'none', border: 'none', color: '#1e3a8a', fontWeight: 600, cursor: 'pointer', fontSize: '0.8125rem', padding: 0 }}
                  >
                    {showFilters ? '‚ñº Hide Filters' : '‚ñ∂ More Filters'} (Sort)
                  </button>
                  <span style={{ fontSize: '0.8125rem', color: '#64748b' }}>
                    {filteredBills.length} bill{filteredBills.length !== 1 ? 's' : ''}
                  </span>
                </div>

                {showFilters && (
                  <div style={{ background: 'white', padding: '1rem', borderRadius: '0.75rem', marginBottom: '1rem', display: 'flex', gap: '1rem', flexWrap: 'wrap', alignItems: 'center' }}>
                    <div>
                      <label style={{ fontSize: '0.75rem', fontWeight: 600, color: '#64748b', display: 'block', marginBottom: '0.25rem' }}>Sort By</label>
                      <select
                        value={sortBy}
                        onChange={e => setSortBy(e.target.value)}
                        style={{ padding: '0.5rem', borderRadius: '0.375rem', border: '2px solid #e2e8f0', fontSize: '0.875rem' }}
                      >
                        <option value="urgent">Most Urgent</option>
                        <option value="recent">Newest First</option>
                        <option value="oldest">Oldest First</option>
                      </select>
                    </div>
                  </div>
                )}

                {/* Bill list */}
                {loading ? (
                  <div style={{ display: 'flex', justifyContent: 'center', padding: '4rem' }}>
                    <div className="spinner"></div>
                  </div>
                ) : filteredBills.length === 0 ? (
                  <div style={{ textAlign: 'center', padding: '4rem 2rem', background: 'white', borderRadius: '1rem' }}>
                    <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üì≠</div>
                    <h3 style={{ fontWeight: 700, color: '#334155', marginBottom: '0.5rem' }}>
                      {activeTab === 'watchlist' ? 'Your watchlist is empty' : 'No bills match your filters'}
                    </h3>
                    <p style={{ color: '#64748b' }}>
                      {activeTab === 'watchlist' ? 'Tap the ‚≠ê on any bill to add it here.' : 'Try broadening your search or changing filters.'}
                    </p>
                  </div>
                ) : (
                  <div>
                    {filteredBills.map(bill => (
                      <BillCard
                        key={bill.id || bill.url || Math.random()}
                        bill={bill}
                        onViewDetails={setSelectedBill}
                        watchlist={watchlist}
                        toggleWatchlist={toggleWatchlist}
                      />
                    ))}

                    {/* Pagination */}
                    {activeTab === 'all' && hasMoreBills && (
                      <div style={{ display: 'flex', justifyContent: 'center', marginTop: '1rem' }}>
                        <button
                          className="btn btn-secondary"
                          onClick={() => setBillsOffset(prev => prev + PAGE_SIZE)}
                          disabled={loading}
                          style={{ minWidth: '220px', justifyContent: 'center' }}
                        >
                          {loading ? 'Loading‚Ä¶' : 'Load more'}
                        </button>
                      </div>
                    )}
                  </div>
                )}
              </>
            )}
          </main>

          {/* Footer */}
          <footer style={{ backgroundColor: '#0f172a', color: 'white', padding: '1.5rem 1rem', marginTop: '2rem' }}>
            <div style={{ maxWidth: '960px', margin: '0 auto', textAlign: 'center' }}>
              <p style={{ marginBottom: '0.5rem', opacity: 0.9, fontSize: '0.9375rem' }}>Vigilance. Integrity. Community.</p>
              <p style={{ fontSize: '0.8125rem', opacity: 0.6 }}>¬© 2026 Civic Rights Alert System. All bill data from official APIs.</p>
              <p style={{ fontSize: '0.75rem', opacity: 0.5, marginTop: '0.5rem' }}>‚ö†Ô∏è BETA ‚Äî Some features still in development</p>
            </div>
          </footer>

          {/* Drawer */}
          {showDrawer && (
            <>
              <div className="sidebar-overlay" onClick={() => setShowDrawer(false)} />
              <div className="sidebar-drawer">
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>
                  <h2 style={{ fontSize: '1.25rem', fontWeight: 700, color: '#1e3a8a' }}>More Tools</h2>
                  <button onClick={() => setShowDrawer(false)} style={{ background: 'none', border: 'none', fontSize: '1.5rem', cursor: 'pointer', color: '#64748b' }}>‚úï</button>
                </div>

                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                  <button
                    onClick={() => { setShowDrawer(false); alert('Coming soon.'); }}
                    style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '1rem', border: '2px solid #e2e8f0', borderRadius: '0.75rem', background: 'white', cursor: 'pointer', textAlign: 'left', width: '100%' }}
                  >
                    <span style={{ fontSize: '1.5rem' }}>üìß</span>
                    <div>
                      <div style={{ fontWeight: 700, color: '#1e293b' }}>Alerts</div>
                      <div style={{ fontSize: '0.8125rem', color: '#64748b' }}>Email & SMS notifications</div>
                    </div>
                  </button>

                  <button
                    onClick={() => { setShowDrawer(false); alert('Coming soon.'); }}
                    style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '1rem', border: '2px solid #e2e8f0', borderRadius: '0.75rem', background: 'white', cursor: 'pointer', textAlign: 'left', width: '100%' }}
                  >
                    <span style={{ fontSize: '1.5rem' }}>üéØ</span>
                    <div>
                      <div style={{ fontWeight: 700, color: '#1e293b' }}>Strategic Guide</div>
                      <div style={{ fontSize: '0.8125rem', color: '#64748b' }}>How to influence bills</div>
                    </div>
                  </button>
                </div>

                <div style={{ marginTop: '2rem', padding: '1rem', backgroundColor: '#f1f5f9', borderRadius: '0.75rem' }}>
                  <p style={{ fontSize: '0.8125rem', color: '#64748b', margin: 0, lineHeight: 1.5 }}>
                    Arizona: the city dropdown appears only after selecting Arizona. Portal links work for all listed AZ cities. Deep city data is best on Legistar cities.
                  </p>
                </div>
              </div>
            </>
          )}

          {/* Bill modal */}
          <BillDetailsModal bill={selectedBill} onClose={() => setSelectedBill(null)} />
        </div>
      );
    }

    // =========================================================
    // MOUNT APP (React 18)
    // =========================================================
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CivicAlertApp />);
  </script>
</body>
</html>
